name: Release
# Release automation powered by release-please.

on:
  workflow_dispatch:
  pull_request:
    types:
      - closed

# Prevent overlapping release-please runs on the same ref.
concurrency:
  group: release-${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  release-please:
    # Only run when a Release Please PR branch is merged into main.
    if: >-
      github.event_name == 'workflow_dispatch' ||
      (
        github.event.pull_request.merged == true &&
        github.event.pull_request.base.ref == 'main' &&
        startsWith(github.event.pull_request.head.ref, 'release-please--')
      )
    uses: luamod/.github/.github/workflows/release.yml@v1
